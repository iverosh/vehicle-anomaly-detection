# Система обнаружения аномалий в телеметрии транспортных средств

Этот проект предоставляет решение для генерации и обнаружения аномалий в данных телеметрии транспортных средств. Система включает возможности генерации данных, обучения моделей и обнаружения аномалий.

## Основные возможности

- Генерация синтетических телеметрических данных с настраиваемыми аномалиями
- Обучение моделей машинного обучения для обнаружения аномалий
- REST API для взаимодействия с системой
- Визуализация сгенерированных данных


## TEST METRICS на датасете из demo_data:

              precision    recall  f1-score   support

    gps_loss     0.9832    0.9688    0.9759      1089
      normal     0.9960    0.9979    0.9970      9201
  wheel_slip     0.9994    0.9982    0.9988      1708

    accuracy                         0.9953     11998
   macro avg     0.9929    0.9883    0.9906     11998
weighted avg     0.9953    0.9953    0.9953     11998

## Требования

- Python 3.8+
- Менеджер пакетов pip

## Установка

1. Клонируйте репозиторий:
```bash
git clone https://github.com/yourusername/vehicle-anomaly-detection.git
cd vehicle-anomaly-detection
```

2. Создайте и активируйте виртуальное окружение (рекомендуется):
```bash
python -m venv venv
source venv/bin/activate  # Для Windows используйте `venv\Scripts\activate`
```

3. Установите зависимости:
```bash
pip install -r requirements.txt
```

## Использование

### 1. Генерация тестового набора данных

Сгенерируйте набор данных с аномалиями:
```bash
python generate_dataset.py --duration 60 --anomaly_freq 200 --anomaly_len 60 --dataset_name dataset.csv --graphics_name plot.png
```

Параметры:
- `--duration`: Длительность в минутах (минимум 60)
- `--anomaly_freq`: Частота аномалий в секундах
- `--anomaly_len`: Длительность каждой аномалии в секундах
- `--dataset_name`: Имя выходного CSV-файла
- `--graphics_name`: Имя выходного файла с графиком

### 2. Обучение модели

Обучите модель обнаружения аномалий:
```bash
python train.py
```

Это выполнит:
- Генерацию обучающего и тестового наборов данных
- Обучение классификатора RandomForest
- Сохранение модели в `models/random_forest_model.pkl`
- Вывод метрик оценки


Приложение будет доступно по адресу `http://localhost:5000`

### 3. Обнаружение аномалий через CLI

Обнаружение аномалий в наборе данных:
```bash
python anomaly_detector.py --dataset путь/к/файлу.csv --anomaly wheel_slip --model_path models
```

Параметры:
- `--dataset`: Путь к входному CSV-файлу
- `--anomaly`: Тип аномалии для обнаружения (`wheel_slip` или `gps_loss`)
- `--model_path`: Путь к директории с обученными моделями

### 4. Запуск веб-приложения

Запустите Flask-сервер:
```bash
python app.py
```
Внутри него можно сделать генерацию данных и детектировать аномалии
![Скрин главной страницы](flask-photo.png)
## Структура проекта

```
.
├── models/               # Сохраненные ML-модели
├── uploads/              # Временные загруженные файлы
├── results/              # Сгенерированные наборы данных и графики
├── app.py                # Flask-приложение
├── anomaly_detector.py   # Логика обнаружения аномалий
├── config.py            # Параметры конфигурации
├── generate_dataset.py   # Генерация данных
├── train.py             # Обучение модели
└── requirements.txt     # Зависимости
```

## Конфигурация

Отредактируйте `config.py` для настройки:
- Радиуса колеса
- Ограничений скорости
- Параметров модели
- Путей к файлам

